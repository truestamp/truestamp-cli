import { getAlgorithm } from "./algorithm.ts";
import { base64url } from "./deps.ts";
import { encoder } from "./mod.ts";
export async function verify(signature, key, alg, signingInput) {
    return key === null ? signature.length === 0 : await crypto.subtle.verify(getAlgorithm(alg), key, signature, encoder.encode(signingInput));
}
export async function create(alg, key, signingInput) {
    return key === null ? "" : base64url.encode(new Uint8Array(await crypto.subtle.sign(getAlgorithm(alg), key, encoder.encode(signingInput))));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2lnbmF0dXJlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsic2lnbmF0dXJlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUM5QyxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFJbkMsTUFBTSxDQUFDLEtBQUssVUFBVSxNQUFNLENBQzFCLFNBQXFCLEVBQ3JCLEdBQXFCLEVBQ3JCLEdBQWMsRUFDZCxZQUFvQjtJQUVwQixPQUFPLEdBQUcsS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUN2RSxZQUFZLENBQUMsR0FBRyxDQUFDLEVBQ2pCLEdBQUcsRUFDSCxTQUFTLEVBQ1QsT0FBTyxDQUFDLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FDN0IsQ0FBQztBQUNKLENBQUM7QUFFRCxNQUFNLENBQUMsS0FBSyxVQUFVLE1BQU0sQ0FDMUIsR0FBYyxFQUNkLEdBQXFCLEVBQ3JCLFlBQW9CO0lBRXBCLE9BQU8sR0FBRyxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUN6QyxJQUFJLFVBQVUsQ0FDWixNQUFNLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUN0QixZQUFZLENBQUMsR0FBRyxDQUFDLEVBQ2pCLEdBQUcsRUFDSCxPQUFPLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUM3QixDQUNGLENBQ0YsQ0FBQztBQUNKLENBQUMifQ==