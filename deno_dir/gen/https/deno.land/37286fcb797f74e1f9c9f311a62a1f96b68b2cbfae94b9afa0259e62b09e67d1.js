import { getDefaultValue, getOption, paramCaseToCamelCase } from "./_utils.ts";
import { ConflictingOption, DependingOption, MissingOptionValue, MissingRequiredOption, OptionNotCombinable, UnknownOption } from "./_errors.ts";
/**
 * Flags post validation. Validations that are not already done by the parser.
 *
 * @param opts            Parse options.
 * @param values          Flag values.
 * @param optionNameMap   Option name mappings: propertyName -> option.name
 */ export function validateFlags(opts, values, optionNameMap = {}) {
    if (!opts.flags) {
        return;
    }
    const defaultValues = setDefaultValues(opts, values, optionNameMap);
    const optionNames = Object.keys(values);
    if (!optionNames.length && opts.allowEmpty) {
        return;
    }
    const options = optionNames.map((name)=>({
            name,
            option: getOption(opts.flags, optionNameMap[name])
        }));
    for (const { name , option  } of options){
        if (!option) {
            throw new UnknownOption(name, opts.flags);
        }
        if (validateStandaloneOption(option, options, optionNames, defaultValues)) {
            return;
        }
        validateConflictingOptions(option, values);
        validateDependingOptions(option, values, defaultValues);
        validateRequiredValues(option, values, name);
    }
    validateRequiredOptions(options, values, opts);
}
/**
 * Adds all default values on the values object and returns a new object with
 * only the default values.
 *
 * @param opts
 * @param values
 * @param optionNameMap
 */ function setDefaultValues(opts, values, optionNameMap = {}) {
    const defaultValues = {};
    if (!opts.flags?.length) {
        return defaultValues;
    }
    // Set default values
    for (const option of opts.flags){
        let name;
        let defaultValue = undefined;
        // if --no-[flag] is present set --[flag] default value to true
        if (option.name.startsWith("no-")) {
            const propName = option.name.replace(/^no-/, "");
            if (propName in values) {
                continue;
            }
            const positiveOption = getOption(opts.flags, propName);
            if (positiveOption) {
                continue;
            }
            name = paramCaseToCamelCase(propName);
            defaultValue = true;
        }
        if (!name) {
            name = paramCaseToCamelCase(option.name);
        }
        if (!(name in optionNameMap)) {
            optionNameMap[name] = option.name;
        }
        const hasDefaultValue = (!opts.ignoreDefaults || typeof opts.ignoreDefaults[name] === "undefined") && typeof values[name] === "undefined" && (typeof option.default !== "undefined" || typeof defaultValue !== "undefined");
        if (hasDefaultValue) {
            values[name] = getDefaultValue(option) ?? defaultValue;
            defaultValues[option.name] = true;
            if (typeof option.value === "function") {
                values[name] = option.value(values[name]);
            }
        }
    }
    return defaultValues;
}
function validateStandaloneOption(option, options, optionNames, defaultValues) {
    if (!option.standalone) {
        return false;
    }
    if (optionNames.length === 1) {
        return true;
    }
    // don't throw an error if all values are coming from the default option.
    if (options.every((opt)=>opt.option && (option === opt.option || defaultValues[opt.option.name]))) {
        return true;
    }
    throw new OptionNotCombinable(option.name);
}
function validateConflictingOptions(option, values) {
    option.conflicts?.forEach((flag)=>{
        if (isset(flag, values)) {
            throw new ConflictingOption(option.name, flag);
        }
    });
}
function validateDependingOptions(option, values, defaultValues) {
    option.depends?.forEach((flag)=>{
        // don't throw an error if the value is coming from the default option.
        if (!isset(flag, values) && !defaultValues[option.name]) {
            throw new DependingOption(option.name, flag);
        }
    });
}
function validateRequiredValues(option, values, name) {
    const isArray = (option.args?.length || 0) > 1;
    option.args?.forEach((arg, i)=>{
        if (arg.requiredValue && (typeof values[name] === "undefined" || isArray && typeof values[name][i] === "undefined")) {
            throw new MissingOptionValue(option.name);
        }
    });
}
function validateRequiredOptions(options, values, opts) {
    if (!opts.flags?.length) {
        return;
    }
    for (const option of opts.flags){
        if (option.required && !(paramCaseToCamelCase(option.name) in values)) {
            if ((!option.conflicts || !option.conflicts.find((flag)=>!!values[flag])) && !options.find((opt)=>opt.option?.conflicts?.find((flag)=>flag === option.name))) {
                throw new MissingRequiredOption(option.name);
            }
        }
    }
}
/**
 * Check if value exists for flag.
 * @param flag    Flag name.
 * @param values  Parsed values.
 */ function isset(flag, values) {
    const name = paramCaseToCamelCase(flag);
    // return typeof values[ name ] !== 'undefined' && values[ name ] !== false;
    return typeof values[name] !== "undefined";
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3gvY2xpZmZ5QHYwLjI1LjAvZmxhZ3MvdmFsaWRhdGVfZmxhZ3MudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0RGVmYXVsdFZhbHVlLCBnZXRPcHRpb24sIHBhcmFtQ2FzZVRvQ2FtZWxDYXNlIH0gZnJvbSBcIi4vX3V0aWxzLnRzXCI7XG5pbXBvcnQge1xuICBDb25mbGljdGluZ09wdGlvbixcbiAgRGVwZW5kaW5nT3B0aW9uLFxuICBNaXNzaW5nT3B0aW9uVmFsdWUsXG4gIE1pc3NpbmdSZXF1aXJlZE9wdGlvbixcbiAgT3B0aW9uTm90Q29tYmluYWJsZSxcbiAgVW5rbm93bk9wdGlvbixcbn0gZnJvbSBcIi4vX2Vycm9ycy50c1wiO1xuaW1wb3J0IHsgSVBhcnNlT3B0aW9ucyB9IGZyb20gXCIuL3R5cGVzLnRzXCI7XG5pbXBvcnQgdHlwZSB7IElGbGFnQXJndW1lbnQsIElGbGFnT3B0aW9ucyB9IGZyb20gXCIuL3R5cGVzLnRzXCI7XG5cbi8qKiBGbGFnIG9wdGlvbiBtYXAuICovXG5pbnRlcmZhY2UgSUZsYWdPcHRpb25zTWFwIHtcbiAgbmFtZTogc3RyaW5nO1xuICBvcHRpb24/OiBJRmxhZ09wdGlvbnM7XG59XG5cbi8qKlxuICogRmxhZ3MgcG9zdCB2YWxpZGF0aW9uLiBWYWxpZGF0aW9ucyB0aGF0IGFyZSBub3QgYWxyZWFkeSBkb25lIGJ5IHRoZSBwYXJzZXIuXG4gKlxuICogQHBhcmFtIG9wdHMgICAgICAgICAgICBQYXJzZSBvcHRpb25zLlxuICogQHBhcmFtIHZhbHVlcyAgICAgICAgICBGbGFnIHZhbHVlcy5cbiAqIEBwYXJhbSBvcHRpb25OYW1lTWFwICAgT3B0aW9uIG5hbWUgbWFwcGluZ3M6IHByb3BlcnR5TmFtZSAtPiBvcHRpb24ubmFtZVxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVGbGFnczxUIGV4dGVuZHMgSUZsYWdPcHRpb25zID0gSUZsYWdPcHRpb25zPihcbiAgb3B0czogSVBhcnNlT3B0aW9uczxUPixcbiAgdmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPixcbiAgb3B0aW9uTmFtZU1hcDogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9LFxuKTogdm9pZCB7XG4gIGlmICghb3B0cy5mbGFncykge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBkZWZhdWx0VmFsdWVzID0gc2V0RGVmYXVsdFZhbHVlcyhvcHRzLCB2YWx1ZXMsIG9wdGlvbk5hbWVNYXApO1xuXG4gIGNvbnN0IG9wdGlvbk5hbWVzID0gT2JqZWN0LmtleXModmFsdWVzKTtcbiAgaWYgKCFvcHRpb25OYW1lcy5sZW5ndGggJiYgb3B0cy5hbGxvd0VtcHR5KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3Qgb3B0aW9uczogQXJyYXk8SUZsYWdPcHRpb25zTWFwPiA9IG9wdGlvbk5hbWVzLm1hcCgobmFtZSkgPT4gKHtcbiAgICBuYW1lLFxuICAgIG9wdGlvbjogZ2V0T3B0aW9uKG9wdHMuZmxhZ3MhLCBvcHRpb25OYW1lTWFwW25hbWVdKSxcbiAgfSkpO1xuXG4gIGZvciAoY29uc3QgeyBuYW1lLCBvcHRpb24gfSBvZiBvcHRpb25zKSB7XG4gICAgaWYgKCFvcHRpb24pIHtcbiAgICAgIHRocm93IG5ldyBVbmtub3duT3B0aW9uKG5hbWUsIG9wdHMuZmxhZ3MpO1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGVTdGFuZGFsb25lT3B0aW9uKG9wdGlvbiwgb3B0aW9ucywgb3B0aW9uTmFtZXMsIGRlZmF1bHRWYWx1ZXMpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhbGlkYXRlQ29uZmxpY3RpbmdPcHRpb25zKG9wdGlvbiwgdmFsdWVzKTtcbiAgICB2YWxpZGF0ZURlcGVuZGluZ09wdGlvbnMob3B0aW9uLCB2YWx1ZXMsIGRlZmF1bHRWYWx1ZXMpO1xuICAgIHZhbGlkYXRlUmVxdWlyZWRWYWx1ZXMob3B0aW9uLCB2YWx1ZXMsIG5hbWUpO1xuICB9XG4gIHZhbGlkYXRlUmVxdWlyZWRPcHRpb25zKG9wdGlvbnMsIHZhbHVlcywgb3B0cyk7XG59XG5cbi8qKlxuICogQWRkcyBhbGwgZGVmYXVsdCB2YWx1ZXMgb24gdGhlIHZhbHVlcyBvYmplY3QgYW5kIHJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGhcbiAqIG9ubHkgdGhlIGRlZmF1bHQgdmFsdWVzLlxuICpcbiAqIEBwYXJhbSBvcHRzXG4gKiBAcGFyYW0gdmFsdWVzXG4gKiBAcGFyYW0gb3B0aW9uTmFtZU1hcFxuICovXG5mdW5jdGlvbiBzZXREZWZhdWx0VmFsdWVzPFQgZXh0ZW5kcyBJRmxhZ09wdGlvbnMgPSBJRmxhZ09wdGlvbnM+KFxuICBvcHRzOiBJUGFyc2VPcHRpb25zPFQ+LFxuICB2YWx1ZXM6IFJlY29yZDxzdHJpbmcsIHVua25vd24+LFxuICBvcHRpb25OYW1lTWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge30sXG4pIHtcbiAgY29uc3QgZGVmYXVsdFZhbHVlczogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4gPSB7fTtcbiAgaWYgKCFvcHRzLmZsYWdzPy5sZW5ndGgpIHtcbiAgICByZXR1cm4gZGVmYXVsdFZhbHVlcztcbiAgfVxuXG4gIC8vIFNldCBkZWZhdWx0IHZhbHVlc1xuICBmb3IgKGNvbnN0IG9wdGlvbiBvZiBvcHRzLmZsYWdzKSB7XG4gICAgbGV0IG5hbWU6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICBsZXQgZGVmYXVsdFZhbHVlOiB1bmtub3duID0gdW5kZWZpbmVkO1xuXG4gICAgLy8gaWYgLS1uby1bZmxhZ10gaXMgcHJlc2VudCBzZXQgLS1bZmxhZ10gZGVmYXVsdCB2YWx1ZSB0byB0cnVlXG4gICAgaWYgKG9wdGlvbi5uYW1lLnN0YXJ0c1dpdGgoXCJuby1cIikpIHtcbiAgICAgIGNvbnN0IHByb3BOYW1lID0gb3B0aW9uLm5hbWUucmVwbGFjZSgvXm5vLS8sIFwiXCIpO1xuICAgICAgaWYgKHByb3BOYW1lIGluIHZhbHVlcykge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHBvc2l0aXZlT3B0aW9uID0gZ2V0T3B0aW9uKG9wdHMuZmxhZ3MsIHByb3BOYW1lKTtcbiAgICAgIGlmIChwb3NpdGl2ZU9wdGlvbikge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIG5hbWUgPSBwYXJhbUNhc2VUb0NhbWVsQ2FzZShwcm9wTmFtZSk7XG4gICAgICBkZWZhdWx0VmFsdWUgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmICghbmFtZSkge1xuICAgICAgbmFtZSA9IHBhcmFtQ2FzZVRvQ2FtZWxDYXNlKG9wdGlvbi5uYW1lKTtcbiAgICB9XG5cbiAgICBpZiAoIShuYW1lIGluIG9wdGlvbk5hbWVNYXApKSB7XG4gICAgICBvcHRpb25OYW1lTWFwW25hbWVdID0gb3B0aW9uLm5hbWU7XG4gICAgfVxuXG4gICAgY29uc3QgaGFzRGVmYXVsdFZhbHVlOiBib29sZWFuID0gKCFvcHRzLmlnbm9yZURlZmF1bHRzIHx8XG4gICAgICB0eXBlb2Ygb3B0cy5pZ25vcmVEZWZhdWx0c1tuYW1lXSA9PT0gXCJ1bmRlZmluZWRcIikgJiZcbiAgICAgIHR5cGVvZiB2YWx1ZXNbbmFtZV0gPT09IFwidW5kZWZpbmVkXCIgJiYgKFxuICAgICAgICB0eXBlb2Ygb3B0aW9uLmRlZmF1bHQgIT09IFwidW5kZWZpbmVkXCIgfHxcbiAgICAgICAgdHlwZW9mIGRlZmF1bHRWYWx1ZSAhPT0gXCJ1bmRlZmluZWRcIlxuICAgICAgKTtcblxuICAgIGlmIChoYXNEZWZhdWx0VmFsdWUpIHtcbiAgICAgIHZhbHVlc1tuYW1lXSA9IGdldERlZmF1bHRWYWx1ZShvcHRpb24pID8/IGRlZmF1bHRWYWx1ZTtcbiAgICAgIGRlZmF1bHRWYWx1ZXNbb3B0aW9uLm5hbWVdID0gdHJ1ZTtcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uLnZhbHVlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgdmFsdWVzW25hbWVdID0gb3B0aW9uLnZhbHVlKHZhbHVlc1tuYW1lXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGRlZmF1bHRWYWx1ZXM7XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlU3RhbmRhbG9uZU9wdGlvbihcbiAgb3B0aW9uOiBJRmxhZ09wdGlvbnMsXG4gIG9wdGlvbnM6IEFycmF5PElGbGFnT3B0aW9uc01hcD4sXG4gIG9wdGlvbk5hbWVzOiBBcnJheTxzdHJpbmc+LFxuICBkZWZhdWx0VmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPixcbik6IGJvb2xlYW4ge1xuICBpZiAoIW9wdGlvbi5zdGFuZGFsb25lKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmIChvcHRpb25OYW1lcy5sZW5ndGggPT09IDEpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8vIGRvbid0IHRocm93IGFuIGVycm9yIGlmIGFsbCB2YWx1ZXMgYXJlIGNvbWluZyBmcm9tIHRoZSBkZWZhdWx0IG9wdGlvbi5cbiAgaWYgKFxuICAgIG9wdGlvbnMuZXZlcnkoKG9wdCkgPT5cbiAgICAgIG9wdC5vcHRpb24gJiZcbiAgICAgIChvcHRpb24gPT09IG9wdC5vcHRpb24gfHwgZGVmYXVsdFZhbHVlc1tvcHQub3B0aW9uLm5hbWVdKVxuICAgIClcbiAgKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICB0aHJvdyBuZXcgT3B0aW9uTm90Q29tYmluYWJsZShvcHRpb24ubmFtZSk7XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlQ29uZmxpY3RpbmdPcHRpb25zKFxuICBvcHRpb246IElGbGFnT3B0aW9ucyxcbiAgdmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPixcbik6IHZvaWQge1xuICBvcHRpb24uY29uZmxpY3RzPy5mb3JFYWNoKChmbGFnOiBzdHJpbmcpID0+IHtcbiAgICBpZiAoaXNzZXQoZmxhZywgdmFsdWVzKSkge1xuICAgICAgdGhyb3cgbmV3IENvbmZsaWN0aW5nT3B0aW9uKG9wdGlvbi5uYW1lLCBmbGFnKTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZURlcGVuZGluZ09wdGlvbnMoXG4gIG9wdGlvbjogSUZsYWdPcHRpb25zLFxuICB2YWx1ZXM6IFJlY29yZDxzdHJpbmcsIHVua25vd24+LFxuICBkZWZhdWx0VmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPixcbik6IHZvaWQge1xuICBvcHRpb24uZGVwZW5kcz8uZm9yRWFjaCgoZmxhZzogc3RyaW5nKSA9PiB7XG4gICAgLy8gZG9uJ3QgdGhyb3cgYW4gZXJyb3IgaWYgdGhlIHZhbHVlIGlzIGNvbWluZyBmcm9tIHRoZSBkZWZhdWx0IG9wdGlvbi5cbiAgICBpZiAoIWlzc2V0KGZsYWcsIHZhbHVlcykgJiYgIWRlZmF1bHRWYWx1ZXNbb3B0aW9uLm5hbWVdKSB7XG4gICAgICB0aHJvdyBuZXcgRGVwZW5kaW5nT3B0aW9uKG9wdGlvbi5uYW1lLCBmbGFnKTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZVJlcXVpcmVkVmFsdWVzKFxuICBvcHRpb246IElGbGFnT3B0aW9ucyxcbiAgdmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPixcbiAgbmFtZTogc3RyaW5nLFxuKTogdm9pZCB7XG4gIGNvbnN0IGlzQXJyYXkgPSAob3B0aW9uLmFyZ3M/Lmxlbmd0aCB8fCAwKSA+IDE7XG4gIG9wdGlvbi5hcmdzPy5mb3JFYWNoKChhcmc6IElGbGFnQXJndW1lbnQsIGk6IG51bWJlcikgPT4ge1xuICAgIGlmIChcbiAgICAgIGFyZy5yZXF1aXJlZFZhbHVlICYmXG4gICAgICAoXG4gICAgICAgIHR5cGVvZiB2YWx1ZXNbbmFtZV0gPT09IFwidW5kZWZpbmVkXCIgfHxcbiAgICAgICAgKGlzQXJyYXkgJiZcbiAgICAgICAgICB0eXBlb2YgKHZhbHVlc1tuYW1lXSBhcyBBcnJheTx1bmtub3duPilbaV0gPT09IFwidW5kZWZpbmVkXCIpXG4gICAgICApXG4gICAgKSB7XG4gICAgICB0aHJvdyBuZXcgTWlzc2luZ09wdGlvblZhbHVlKG9wdGlvbi5uYW1lKTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZVJlcXVpcmVkT3B0aW9uczxUIGV4dGVuZHMgSUZsYWdPcHRpb25zID0gSUZsYWdPcHRpb25zPihcbiAgb3B0aW9uczogQXJyYXk8SUZsYWdPcHRpb25zTWFwPixcbiAgdmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPixcbiAgb3B0czogSVBhcnNlT3B0aW9uczxUPixcbik6IHZvaWQge1xuICBpZiAoIW9wdHMuZmxhZ3M/Lmxlbmd0aCkge1xuICAgIHJldHVybjtcbiAgfVxuICBmb3IgKGNvbnN0IG9wdGlvbiBvZiBvcHRzLmZsYWdzKSB7XG4gICAgaWYgKG9wdGlvbi5yZXF1aXJlZCAmJiAhKHBhcmFtQ2FzZVRvQ2FtZWxDYXNlKG9wdGlvbi5uYW1lKSBpbiB2YWx1ZXMpKSB7XG4gICAgICBpZiAoXG4gICAgICAgIChcbiAgICAgICAgICAhb3B0aW9uLmNvbmZsaWN0cyB8fFxuICAgICAgICAgICFvcHRpb24uY29uZmxpY3RzLmZpbmQoKGZsYWc6IHN0cmluZykgPT4gISF2YWx1ZXNbZmxhZ10pXG4gICAgICAgICkgJiZcbiAgICAgICAgIW9wdGlvbnMuZmluZCgob3B0KSA9PlxuICAgICAgICAgIG9wdC5vcHRpb24/LmNvbmZsaWN0cz8uZmluZCgoZmxhZzogc3RyaW5nKSA9PiBmbGFnID09PSBvcHRpb24ubmFtZSlcbiAgICAgICAgKVxuICAgICAgKSB7XG4gICAgICAgIHRocm93IG5ldyBNaXNzaW5nUmVxdWlyZWRPcHRpb24ob3B0aW9uLm5hbWUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIENoZWNrIGlmIHZhbHVlIGV4aXN0cyBmb3IgZmxhZy5cbiAqIEBwYXJhbSBmbGFnICAgIEZsYWcgbmFtZS5cbiAqIEBwYXJhbSB2YWx1ZXMgIFBhcnNlZCB2YWx1ZXMuXG4gKi9cbmZ1bmN0aW9uIGlzc2V0KGZsYWc6IHN0cmluZywgdmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik6IGJvb2xlYW4ge1xuICBjb25zdCBuYW1lID0gcGFyYW1DYXNlVG9DYW1lbENhc2UoZmxhZyk7XG4gIC8vIHJldHVybiB0eXBlb2YgdmFsdWVzWyBuYW1lIF0gIT09ICd1bmRlZmluZWQnICYmIHZhbHVlc1sgbmFtZSBdICE9PSBmYWxzZTtcbiAgcmV0dXJuIHR5cGVvZiB2YWx1ZXNbbmFtZV0gIT09IFwidW5kZWZpbmVkXCI7XG59XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsU0FBUyxlQUFlLEVBQUUsU0FBUyxFQUFFLG9CQUFvQixRQUFRLGFBQWEsQ0FBQztBQUMvRSxTQUNFLGlCQUFpQixFQUNqQixlQUFlLEVBQ2Ysa0JBQWtCLEVBQ2xCLHFCQUFxQixFQUNyQixtQkFBbUIsRUFDbkIsYUFBYSxRQUNSLGNBQWMsQ0FBQztBQVV0Qjs7Ozs7O0NBTUMsR0FDRCxPQUFPLFNBQVMsYUFBYSxDQUMzQixJQUFzQixFQUN0QixNQUErQixFQUMvQixhQUFxQyxHQUFHLEVBQUUsRUFDcEM7SUFDTixJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRTtRQUNmLE9BQU87SUFDVCxDQUFDO0lBQ0QsTUFBTSxhQUFhLEdBQUcsZ0JBQWdCLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxhQUFhLENBQUMsQUFBQztJQUVwRSxNQUFNLFdBQVcsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxBQUFDO0lBQ3hDLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUU7UUFDMUMsT0FBTztJQUNULENBQUM7SUFFRCxNQUFNLE9BQU8sR0FBMkIsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksR0FBSyxDQUFDO1lBQ2pFLElBQUk7WUFDSixNQUFNLEVBQUUsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUcsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3BELENBQUMsQ0FBQyxBQUFDO0lBRUosS0FBSyxNQUFNLEVBQUUsSUFBSSxDQUFBLEVBQUUsTUFBTSxDQUFBLEVBQUUsSUFBSSxPQUFPLENBQUU7UUFDdEMsSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUNYLE1BQU0sSUFBSSxhQUFhLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM1QyxDQUFDO1FBQ0QsSUFBSSx3QkFBd0IsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLFdBQVcsRUFBRSxhQUFhLENBQUMsRUFBRTtZQUN6RSxPQUFPO1FBQ1QsQ0FBQztRQUNELDBCQUEwQixDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQztRQUMzQyx3QkFBd0IsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLGFBQWEsQ0FBQyxDQUFDO1FBQ3hELHNCQUFzQixDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDL0MsQ0FBQztJQUNELHVCQUF1QixDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDakQsQ0FBQztBQUVEOzs7Ozs7O0NBT0MsR0FDRCxTQUFTLGdCQUFnQixDQUN2QixJQUFzQixFQUN0QixNQUErQixFQUMvQixhQUFxQyxHQUFHLEVBQUUsRUFDMUM7SUFDQSxNQUFNLGFBQWEsR0FBNEIsRUFBRSxBQUFDO0lBQ2xELElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRTtRQUN2QixPQUFPLGFBQWEsQ0FBQztJQUN2QixDQUFDO0lBRUQscUJBQXFCO0lBQ3JCLEtBQUssTUFBTSxNQUFNLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBRTtRQUMvQixJQUFJLElBQUksQUFBb0IsQUFBQztRQUM3QixJQUFJLFlBQVksR0FBWSxTQUFTLEFBQUM7UUFFdEMsK0RBQStEO1FBQy9ELElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLEVBQUU7WUFDakMsTUFBTSxRQUFRLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLFNBQVMsRUFBRSxDQUFDLEFBQUM7WUFDakQsSUFBSSxRQUFRLElBQUksTUFBTSxFQUFFO2dCQUN0QixTQUFTO1lBQ1gsQ0FBQztZQUNELE1BQU0sY0FBYyxHQUFHLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxBQUFDO1lBQ3ZELElBQUksY0FBYyxFQUFFO2dCQUNsQixTQUFTO1lBQ1gsQ0FBQztZQUNELElBQUksR0FBRyxvQkFBb0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUN0QyxZQUFZLEdBQUcsSUFBSSxDQUFDO1FBQ3RCLENBQUM7UUFFRCxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ1QsSUFBSSxHQUFHLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMzQyxDQUFDO1FBRUQsSUFBSSxDQUFDLENBQUMsSUFBSSxJQUFJLGFBQWEsQ0FBQyxFQUFFO1lBQzVCLGFBQWEsQ0FBQyxJQUFJLENBQUMsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDO1FBQ3BDLENBQUM7UUFFRCxNQUFNLGVBQWUsR0FBWSxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWMsSUFDcEQsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxLQUFLLFdBQVcsQ0FBQyxJQUNqRCxPQUFPLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxXQUFXLElBQUksQ0FDckMsT0FBTyxNQUFNLENBQUMsT0FBTyxLQUFLLFdBQVcsSUFDckMsT0FBTyxZQUFZLEtBQUssV0FBVyxDQUNwQyxBQUFDO1FBRUosSUFBSSxlQUFlLEVBQUU7WUFDbkIsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLGVBQWUsQ0FBQyxNQUFNLENBQUMsSUFBSSxZQUFZLENBQUM7WUFDdkQsYUFBYSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUM7WUFDbEMsSUFBSSxPQUFPLE1BQU0sQ0FBQyxLQUFLLEtBQUssVUFBVSxFQUFFO2dCQUN0QyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUM1QyxDQUFDO1FBQ0gsQ0FBQztJQUNILENBQUM7SUFFRCxPQUFPLGFBQWEsQ0FBQztBQUN2QixDQUFDO0FBRUQsU0FBUyx3QkFBd0IsQ0FDL0IsTUFBb0IsRUFDcEIsT0FBK0IsRUFDL0IsV0FBMEIsRUFDMUIsYUFBc0MsRUFDN0I7SUFDVCxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsRUFBRTtRQUN0QixPQUFPLEtBQUssQ0FBQztJQUNmLENBQUM7SUFDRCxJQUFJLFdBQVcsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1FBQzVCLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELHlFQUF5RTtJQUN6RSxJQUNFLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLEdBQ2hCLEdBQUcsQ0FBQyxNQUFNLElBQ1YsQ0FBQyxNQUFNLEtBQUssR0FBRyxDQUFDLE1BQU0sSUFBSSxhQUFhLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUMxRCxFQUNEO1FBQ0EsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBRUQsTUFBTSxJQUFJLG1CQUFtQixDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUM3QyxDQUFDO0FBRUQsU0FBUywwQkFBMEIsQ0FDakMsTUFBb0IsRUFDcEIsTUFBK0IsRUFDekI7SUFDTixNQUFNLENBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDLElBQVksR0FBSztRQUMxQyxJQUFJLEtBQUssQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLEVBQUU7WUFDdkIsTUFBTSxJQUFJLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDakQsQ0FBQztJQUNILENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQUVELFNBQVMsd0JBQXdCLENBQy9CLE1BQW9CLEVBQ3BCLE1BQStCLEVBQy9CLGFBQXNDLEVBQ2hDO0lBQ04sTUFBTSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQyxJQUFZLEdBQUs7UUFDeEMsdUVBQXVFO1FBQ3ZFLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUN2RCxNQUFNLElBQUksZUFBZSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDL0MsQ0FBQztJQUNILENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQUVELFNBQVMsc0JBQXNCLENBQzdCLE1BQW9CLEVBQ3BCLE1BQStCLEVBQy9CLElBQVksRUFDTjtJQUNOLE1BQU0sT0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxNQUFNLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxBQUFDO0lBQy9DLE1BQU0sQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUMsR0FBa0IsRUFBRSxDQUFTLEdBQUs7UUFDdEQsSUFDRSxHQUFHLENBQUMsYUFBYSxJQUNqQixDQUNFLE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLFdBQVcsSUFDbEMsT0FBTyxJQUNOLE9BQU8sQUFBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEFBQW1CLENBQUMsQ0FBQyxDQUFDLEtBQUssV0FBVyxBQUFDLENBQzlELEVBQ0Q7WUFDQSxNQUFNLElBQUksa0JBQWtCLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzVDLENBQUM7SUFDSCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUM7QUFFRCxTQUFTLHVCQUF1QixDQUM5QixPQUErQixFQUMvQixNQUErQixFQUMvQixJQUFzQixFQUNoQjtJQUNOLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRTtRQUN2QixPQUFPO0lBQ1QsQ0FBQztJQUNELEtBQUssTUFBTSxNQUFNLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBRTtRQUMvQixJQUFJLE1BQU0sQ0FBQyxRQUFRLElBQUksQ0FBQyxDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxNQUFNLENBQUMsRUFBRTtZQUNyRSxJQUNFLENBQ0UsQ0FBQyxNQUFNLENBQUMsU0FBUyxJQUNqQixDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBWSxHQUFLLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FDekQsSUFDRCxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLEdBQ2hCLEdBQUcsQ0FBQyxNQUFNLEVBQUUsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDLElBQVksR0FBSyxJQUFJLEtBQUssTUFBTSxDQUFDLElBQUksQ0FBQyxDQUNwRSxFQUNEO2dCQUNBLE1BQU0sSUFBSSxxQkFBcUIsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDL0MsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0FBQ0gsQ0FBQztBQUVEOzs7O0NBSUMsR0FDRCxTQUFTLEtBQUssQ0FBQyxJQUFZLEVBQUUsTUFBK0IsRUFBVztJQUNyRSxNQUFNLElBQUksR0FBRyxvQkFBb0IsQ0FBQyxJQUFJLENBQUMsQUFBQztJQUN4Qyw0RUFBNEU7SUFDNUUsT0FBTyxPQUFPLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxXQUFXLENBQUM7QUFDN0MsQ0FBQyJ9