import { encode } from "./../../src/utility/encode.ts";
import { rsa_export_pkcs8_private, rsa_export_pkcs8_public, } from "./export_key.ts";
export class RSAKey {
    n;
    e;
    d;
    p;
    q;
    dp;
    dq;
    qi;
    length;
    constructor(params) {
        this.n = params.n;
        this.e = params.e;
        this.d = params.d;
        this.p = params.p;
        this.q = params.q;
        this.dp = params.dp;
        this.dq = params.dq;
        this.qi = params.qi;
        this.length = params.length;
    }
    pem() {
        if (this.d) {
            return rsa_export_pkcs8_private(this);
        }
        else {
            return rsa_export_pkcs8_public(this);
        }
    }
    jwk() {
        let jwk = {
            kty: "RSA",
            n: encode.bigint(this.n).base64url(),
        };
        if (this.d)
            jwk = { ...jwk, d: encode.bigint(this.d).base64url() };
        if (this.e)
            jwk = { ...jwk, e: encode.bigint(this.e).base64url() };
        if (this.p)
            jwk = { ...jwk, p: encode.bigint(this.p).base64url() };
        if (this.q)
            jwk = { ...jwk, q: encode.bigint(this.q).base64url() };
        if (this.dp)
            jwk = { ...jwk, dp: encode.bigint(this.dp).base64url() };
        if (this.dq)
            jwk = { ...jwk, dq: encode.bigint(this.dq).base64url() };
        if (this.qi)
            jwk = { ...jwk, qi: encode.bigint(this.qi).base64url() };
        return jwk;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicnNhX2tleS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInJzYV9rZXkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQ3ZELE9BQU8sRUFDTCx3QkFBd0IsRUFDeEIsdUJBQXVCLEdBQ3hCLE1BQU0saUJBQWlCLENBQUM7QUFFekIsTUFBTSxPQUFPLE1BQU07SUFDVixDQUFDLENBQVM7SUFDVixDQUFDLENBQVU7SUFDWCxDQUFDLENBQVU7SUFDWCxDQUFDLENBQVU7SUFDWCxDQUFDLENBQVU7SUFDWCxFQUFFLENBQVU7SUFDWixFQUFFLENBQVU7SUFDWixFQUFFLENBQVU7SUFDWixNQUFNLENBQVM7SUFFdEIsWUFBWSxNQUFvQjtRQUM5QixJQUFJLENBQUMsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDbEIsSUFBSSxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDO1FBQ2xCLElBQUksQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUNsQixJQUFJLENBQUMsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDbEIsSUFBSSxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDO1FBQ2xCLElBQUksQ0FBQyxFQUFFLEdBQUcsTUFBTSxDQUFDLEVBQUUsQ0FBQztRQUNwQixJQUFJLENBQUMsRUFBRSxHQUFHLE1BQU0sQ0FBQyxFQUFFLENBQUM7UUFDcEIsSUFBSSxDQUFDLEVBQUUsR0FBRyxNQUFNLENBQUMsRUFBRSxDQUFDO1FBQ3BCLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQztJQUM5QixDQUFDO0lBRU0sR0FBRztRQUNSLElBQUksSUFBSSxDQUFDLENBQUMsRUFBRTtZQUNWLE9BQU8sd0JBQXdCLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDdkM7YUFBTTtZQUNMLE9BQU8sdUJBQXVCLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDdEM7SUFDSCxDQUFDO0lBRU0sR0FBRztRQUNSLElBQUksR0FBRyxHQUFlO1lBQ3BCLEdBQUcsRUFBRSxLQUFLO1lBQ1YsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRTtTQUNyQyxDQUFDO1FBRUYsSUFBSSxJQUFJLENBQUMsQ0FBQztZQUFFLEdBQUcsR0FBRyxFQUFFLEdBQUcsR0FBRyxFQUFFLENBQUMsRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDO1FBQ25FLElBQUksSUFBSSxDQUFDLENBQUM7WUFBRSxHQUFHLEdBQUcsRUFBRSxHQUFHLEdBQUcsRUFBRSxDQUFDLEVBQUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLEVBQUUsQ0FBQztRQUNuRSxJQUFJLElBQUksQ0FBQyxDQUFDO1lBQUUsR0FBRyxHQUFHLEVBQUUsR0FBRyxHQUFHLEVBQUUsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxFQUFFLENBQUM7UUFDbkUsSUFBSSxJQUFJLENBQUMsQ0FBQztZQUFFLEdBQUcsR0FBRyxFQUFFLEdBQUcsR0FBRyxFQUFFLENBQUMsRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDO1FBQ25FLElBQUksSUFBSSxDQUFDLEVBQUU7WUFBRSxHQUFHLEdBQUcsRUFBRSxHQUFHLEdBQUcsRUFBRSxFQUFFLEVBQUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsU0FBUyxFQUFFLEVBQUUsQ0FBQztRQUN0RSxJQUFJLElBQUksQ0FBQyxFQUFFO1lBQUUsR0FBRyxHQUFHLEVBQUUsR0FBRyxHQUFHLEVBQUUsRUFBRSxFQUFFLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFNBQVMsRUFBRSxFQUFFLENBQUM7UUFDdEUsSUFBSSxJQUFJLENBQUMsRUFBRTtZQUFFLEdBQUcsR0FBRyxFQUFFLEdBQUcsR0FBRyxFQUFFLEVBQUUsRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDO1FBRXRFLE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQztDQUNGIn0=