import { Sha1 } from "https://deno.land/std@0.84.0/hash/sha1.ts";
import { Sha256 } from "https://deno.land/std@0.84.0/hash/sha256.ts";
import { Sha512 } from "https://deno.land/std@0.84.0/hash/sha512.ts";
export function digest(algorithm, m) {
    if (algorithm === "sha1") {
        return new Uint8Array(new Sha1().update(m).arrayBuffer());
    }
    else if (algorithm === "sha256") {
        return new Uint8Array(new Sha256().update(m).arrayBuffer());
    }
    else if (algorithm === "sha512") {
        return new Uint8Array(new Sha512().update(m).arrayBuffer());
    }
    throw "Unsupport hash algorithm";
}
export function digestLength(algorithm) {
    if (algorithm === "sha512")
        return 64;
    if (algorithm === "sha256")
        return 32;
    return 20;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGFzaC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImhhc2gudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLDJDQUEyQyxDQUFDO0FBQ2pFLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSw2Q0FBNkMsQ0FBQztBQUNyRSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sNkNBQTZDLENBQUM7QUFHckUsTUFBTSxVQUFVLE1BQU0sQ0FDcEIsU0FBMkIsRUFDM0IsQ0FBYTtJQUViLElBQUksU0FBUyxLQUFLLE1BQU0sRUFBRTtRQUN4QixPQUFPLElBQUksVUFBVSxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7S0FDM0Q7U0FBTSxJQUFJLFNBQVMsS0FBSyxRQUFRLEVBQUU7UUFDakMsT0FBTyxJQUFJLFVBQVUsQ0FBQyxJQUFJLE1BQU0sRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDO0tBQzdEO1NBQU0sSUFBSSxTQUFTLEtBQUssUUFBUSxFQUFFO1FBQ2pDLE9BQU8sSUFBSSxVQUFVLENBQUMsSUFBSSxNQUFNLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztLQUM3RDtJQUVELE1BQU0sMEJBQTBCLENBQUM7QUFDbkMsQ0FBQztBQUVELE1BQU0sVUFBVSxZQUFZLENBQUMsU0FBMkI7SUFDdEQsSUFBSSxTQUFTLEtBQUssUUFBUTtRQUFFLE9BQU8sRUFBRSxDQUFDO0lBQ3RDLElBQUksU0FBUyxLQUFLLFFBQVE7UUFBRSxPQUFPLEVBQUUsQ0FBQztJQUV0QyxPQUFPLEVBQUUsQ0FBQztBQUNaLENBQUMifQ==